<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KrySearch Media</title>

<style>
body {
    margin: 0;
    background: #0f0f0f;
    font-family: system-ui, sans-serif;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.kry-container {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background: black;
}

video, iframe, img {
    max-width: 100%;
    max-height: 100%;
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: black;
}
</style>
</head>
<body>

<div class="kry-container" id="mediaContainer">
</div>

<script>
const params = new URLSearchParams(window.location.search);
const url = params.get("url");

const container = document.getElementById("mediaContainer");

if (!url) {
    container.innerHTML = "<p>No media URL provided</p>";
} 
else if (url.includes("youtube.com") || url.includes("youtu.be")) {
    loadYouTube(url);
}
else if (/\.(mp4|webm|ogg)$/i.test(url)) {
    loadVideo(url);
}
else if (/\.(gif)$/i.test(url)) {
    loadGIF(url);
}
else if (/\.(png|jpg|jpeg|webp|avif)$/i.test(url)) {
    loadImage(url);
}
else {
    container.innerHTML = "<p>Unsupported media type</p>";
}

/* ---------- YOUTUBE ---------- */

function loadYouTube(link) {

    const match = link.match(/(v=|embed\/|youtu\.be\/)([^&]+)/);
    const videoId = match ? match[2] : null;

    if (!videoId) {
        container.innerHTML = "<p>Invalid YouTube URL</p>";
        return;
    }

    const iframe = document.createElement("iframe");
    iframe.src = `https://www.youtube.com/embed/${videoId}?rel=0&modestbranding=1`;
    iframe.allowFullscreen = true;
    iframe.frameBorder = "0";
    iframe.allow = "accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture";

    container.appendChild(iframe);
}

/* ---------- HTML5 VIDEO ---------- */

function loadVideo(src) {
    const video = document.createElement("video");
    video.src = src;
    video.controls = true;
    video.playsInline = true;
    container.appendChild(video);
}

/* ---------- GIF ---------- */

function loadGIF(src) {
    const img = document.createElement("img");
    img.src = src;
    container.appendChild(img);
}

/* ---------- IMAGE ---------- */

function loadImage(src) {
    const img = document.createElement("img");
    img.src = src;
    container.appendChild(img);
}
</script>

</body>
</html>
